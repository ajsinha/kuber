<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{layout :: head('Configuration')}"></head>
<body class="d-flex flex-column min-vh-100">
<nav th:replace="~{layout :: navbar}"></nav>
<main class="flex-fill">
    <div class="container-fluid py-4">
        <nav aria-label="breadcrumb" class="mb-4">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="/help"><i class="fas fa-book me-1"></i>Help</a></li>
                <li class="breadcrumb-item active">Configuration</li>
            </ol>
        </nav>
        <div class="row">
            <div class="col-lg-10 mx-auto">
                <h1 class="display-5 mb-4"><i class="fas fa-cog text-secondary me-3"></i>Configuration</h1>

                <h3>Key Properties</h3>
                <pre class="bg-dark text-light p-3 rounded"><code># Network
kuber.network.port=6379
server.port=8080

# Persistence (rocksdb, mongodb, postgresql, sqlite, memory)
kuber.persistence.type=rocksdb
kuber.persistence.rocksdb.path=./data/rocksdb

# RocksDB Compaction
kuber.persistence.rocksdb.compaction-enabled=true
kuber.persistence.rocksdb.compaction-interval-minutes=30

# SQLite (each region gets separate database file)
kuber.persistence.sqlite.path=./data/sqlite

# Cache Memory Management (v1.1.13)
kuber.cache.max-memory-entries=100000           # Default per-region limit
kuber.cache.global-max-memory-entries=500000    # Global cap across all regions (0=unlimited)
kuber.cache.region-memory-limits.customers=50000   # Per-region override
kuber.cache.region-memory-limits.products=200000   # Per-region override
kuber.cache.persistent-mode=true

# Autoload
kuber.autoload.enabled=true
kuber.autoload.directory=./data/autoload</code></pre>
                
                <div class="alert alert-info mt-3">
                    <i class="fas fa-info-circle me-2"></i>
                    <strong>Region Isolation (v1.1.13):</strong> RocksDB and SQLite now use separate database instances per region for improved concurrency and isolation. Each region has its own directory/file under the configured path.
                </div>
                
                <div class="alert alert-success mt-3">
                    <i class="fas fa-memory me-2"></i>
                    <strong>Smart Memory Allocation (v1.1.13):</strong> When <code>global-max-memory-entries</code> is set and total configured limits exceed the global cap, Kuber uses smart proportional allocation based on 50% configured limits and 50% actual data size.
                </div>
                
                <div class="alert alert-warning mt-3">
                    <i class="fas fa-broom me-2"></i>
                    <strong>Maintenance (v1.1.13):</strong> 
                    <ul class="mb-0 mt-2">
                        <li><strong>RocksDB:</strong> Compaction runs on cron schedule (default: <code>0 0 2 * * ?</code> = 2 AM daily) or trigger manually via API</li>
                        <li><strong>SQLite:</strong> Runs VACUUM on all databases during initialization to optimize storage</li>
                    </ul>
                    <div class="mt-2">
                        <strong>Cron Examples:</strong>
                        <ul class="mb-0">
                            <li><code>0 0 2 * * ?</code> - 2:00 AM daily</li>
                            <li><code>0 0 3 * * SUN</code> - 3:00 AM every Sunday</li>
                            <li><code>0 0 1,13 * * ?</code> - 1:00 AM and 1:00 PM daily</li>
                            <li><code>0 0 */6 * * ?</code> - Every 6 hours</li>
                        </ul>
                    </div>
                </div>
                
                <div class="alert alert-primary mt-3">
                    <i class="fas fa-tachometer-alt me-2"></i>
                    <strong>Fast Entry Counts (v1.1.13):</strong> Dashboard and UI pages use O(1) fast estimates from RocksDB native properties. This ensures instant page loads even with millions of entries. The counts are approximate but highly accurate for typical use cases.
                </div>
                
                <h3 class="mt-4">Security</h3>
                <pre class="bg-dark text-light p-3 rounded"><code>kuber.security.admin-username=admin
kuber.security.admin-password=admin123</code></pre>
                <div class="mt-5 text-center">
                    <a href="/help" class="btn btn-outline-primary"><i class="fas fa-arrow-left me-2"></i>Back to Help Index</a>
                </div>
            </div>
        </div>
        <footer class="py-4 mt-5 border-top">
            <div class="row">
                <div class="col-md-6"><h6><i class="fas fa-database me-2"></i><span th:text="${appName} ?: 'Kuber'">Kuber</span></h6><p class="text-muted small mb-0">Version 1.1.13</p></div>
                <div class="col-md-6 text-end"><p class="text-muted small mb-0">Copyright &copy; 2025-2030 Ashutosh Sinha<br><span class="badge bg-warning text-dark">Patent Pending</span></p></div>
            </div>
        </footer>
    </div>
</main>
<th:block th:replace="~{layout :: scripts}"></th:block>
</body>
</html>