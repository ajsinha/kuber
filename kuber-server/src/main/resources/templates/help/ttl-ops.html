<!DOCTYPE html>
<!--
  ~ Copyright Â© 2025-2030, All Rights Reserved
  ~ Ashutosh Sinha | Email: ajsinha@gmail.com
  ~ Patent Pending
  -->
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{layout :: head('TTL Operations')}"></head>
<body class="d-flex flex-column min-vh-100">
<nav th:replace="~{layout :: navbar}"></nav>
<main class="flex-fill">
    <div class="container-fluid py-4">
        <nav aria-label="breadcrumb" class="mb-4">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="/help"><i class="fas fa-book me-1"></i>Help</a></li>
                <li class="breadcrumb-item active">TTL Operations</li>
            </ol>
        </nav>
        <div class="row">
            <div class="col-lg-11 mx-auto">
                <h1 class="display-5 mb-4"><i class="fas fa-clock text-info me-3"></i>TTL Operations</h1>
                
                <p class="lead">TTL (Time-To-Live) operations let you set automatic expiration on keys. Perfect for sessions, caches, and temporary data.</p>

                <!-- Command Reference Table -->
                <div class="card mb-4">
                    <div class="card-header bg-info text-white">
                        <h5 class="mb-0"><i class="fas fa-list me-2"></i>Command Reference</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead class="table-dark">
                                    <tr><th>Command</th><th>Syntax</th><th>Description</th></tr>
                                </thead>
                                <tbody>
                                    <tr><td><code>TTL</code></td><td><code>TTL key</code></td><td>Get remaining TTL in seconds (-1 if no expiry, -2 if not exists)</td></tr>
                                    <tr><td><code>PTTL</code></td><td><code>PTTL key</code></td><td>Get remaining TTL in milliseconds</td></tr>
                                    <tr><td><code>EXPIRE</code></td><td><code>EXPIRE key seconds</code></td><td>Set expiration in seconds from now</td></tr>
                                    <tr><td><code>PEXPIRE</code></td><td><code>PEXPIRE key milliseconds</code></td><td>Set expiration in milliseconds from now</td></tr>
                                    <tr><td><code>EXPIREAT</code></td><td><code>EXPIREAT key timestamp</code></td><td>Set expiration as Unix timestamp (seconds)</td></tr>
                                    <tr><td><code>PEXPIREAT</code></td><td><code>PEXPIREAT key timestamp</code></td><td>Set expiration as Unix timestamp (milliseconds)</td></tr>
                                    <tr><td><code>PERSIST</code></td><td><code>PERSIST key</code></td><td>Remove expiration, make key persist forever</td></tr>
                                    <tr><td><code>SETEX</code></td><td><code>SETEX key seconds value</code></td><td>Set value with TTL (atomic)</td></tr>
                                    <tr><td><code>PSETEX</code></td><td><code>PSETEX key milliseconds value</code></td><td>Set value with TTL in milliseconds</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- TTL/PTTL Commands -->
                <div class="card mb-4">
                    <div class="card-header"><h5 class="mb-0"><code>TTL</code> / <code>PTTL</code> - Get Remaining Time</h5></div>
                    <div class="card-body">
                        <p>Get the remaining time-to-live for a key. Returns -1 if no expiry, -2 if key doesn't exist.</p>
                        <ul class="nav nav-tabs" role="tablist">
                            <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#ttl-redis">Redis CLI</a></li>
                            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#ttl-python">Python</a></li>
                            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#ttl-java">Java</a></li>
                            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#ttl-csharp">C#</a></li>
                        </ul>
                        <div class="tab-content mt-3">
                            <div class="tab-pane fade show active" id="ttl-redis">
<pre class="bg-dark text-light p-3 rounded"><code># Set key with 1 hour TTL
SETEX session:token 3600 "abc123"

# Get TTL in seconds
TTL session:token
# Returns: 3600 (or less)

# Get TTL in milliseconds
PTTL session:token
# Returns: 3600000 (or less)

# Key without expiry
SET permanent "data"
TTL permanent
# Returns: -1 (no expiry)

# Non-existent key
TTL nonexistent
# Returns: -2</code></pre>
                            </div>
                            <div class="tab-pane fade" id="ttl-python">
<pre class="bg-dark text-light p-3 rounded"><code>with KuberRedisClient('localhost', 6380, api_key='kub_xxx') as client:
    # Set with TTL
    client.setex('session:token', 3600, 'abc123')
    
    # Get TTL in seconds
    ttl = client.ttl('session:token')
    print(f"TTL: {ttl} seconds")  # ~3600
    
    # Get TTL in milliseconds
    pttl = client.pttl('session:token')
    print(f"PTTL: {pttl} ms")  # ~3600000
    
    # Check if key has no expiry
    client.set('permanent', 'data')
    ttl = client.ttl('permanent')
    print(f"TTL: {ttl}")  # -1 (no expiry)</code></pre>
                            </div>
                            <div class="tab-pane fade" id="ttl-java">
<pre class="bg-dark text-light p-3 rounded"><code>try (KuberClient client = new KuberClient("localhost", 6380, "kub_xxx")) {
    // Set with TTL
    client.setex("session:token", 3600, "abc123");
    
    // Get TTL in seconds
    long ttl = client.ttl("session:token");
    System.out.println("TTL: " + ttl + " seconds");
    
    // Get TTL in milliseconds
    long pttl = client.pttl("session:token");
    System.out.println("PTTL: " + pttl + " ms");
    
    // Key without expiry returns -1
    client.set("permanent", "data");
    System.out.println("TTL: " + client.ttl("permanent"));  // -1
}</code></pre>
                            </div>
                            <div class="tab-pane fade" id="ttl-csharp">
<pre class="bg-dark text-light p-3 rounded"><code>using var client = new KuberClient("localhost", 6380, "kub_xxx");

// Set with TTL
await client.SetExAsync("session:token", 3600, "abc123");

// Get TTL in seconds
long ttl = await client.TtlAsync("session:token");
Console.WriteLine($"TTL: {ttl} seconds");

// Get TTL in milliseconds
long pttl = await client.PTtlAsync("session:token");
Console.WriteLine($"PTTL: {pttl} ms");

// Key without expiry returns -1
await client.SetAsync("permanent", "data");
Console.WriteLine($"TTL: {await client.TtlAsync("permanent")}");  // -1</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- EXPIRE/PEXPIRE Commands -->
                <div class="card mb-4">
                    <div class="card-header"><h5 class="mb-0"><code>EXPIRE</code> / <code>PEXPIRE</code> - Set Expiration</h5></div>
                    <div class="card-body">
                        <p>Set a timeout on key. After the timeout, the key is automatically deleted.</p>
                        <ul class="nav nav-tabs" role="tablist">
                            <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#expire-redis">Redis CLI</a></li>
                            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#expire-python">Python</a></li>
                            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#expire-java">Java</a></li>
                            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#expire-csharp">C#</a></li>
                        </ul>
                        <div class="tab-content mt-3">
                            <div class="tab-pane fade show active" id="expire-redis">
<pre class="bg-dark text-light p-3 rounded"><code># Create key
SET mykey "Hello"

# Set to expire in 60 seconds
EXPIRE mykey 60
# Returns: 1 (success)

# Set to expire in 5000 milliseconds
PEXPIRE mykey 5000

# Verify
TTL mykey
# Returns: remaining seconds</code></pre>
                            </div>
                            <div class="tab-pane fade" id="expire-python">
<pre class="bg-dark text-light p-3 rounded"><code>with KuberRedisClient('localhost', 6380, api_key='kub_xxx') as client:
    client.set('mykey', 'Hello')
    
    # Expire in 60 seconds
    client.expire('mykey', 60)
    
    # Expire in 5000 milliseconds
    client.pexpire('mykey', 5000)
    
    # Verify
    print(f"TTL: {client.ttl('mykey')} seconds")</code></pre>
                            </div>
                            <div class="tab-pane fade" id="expire-java">
<pre class="bg-dark text-light p-3 rounded"><code>try (KuberClient client = new KuberClient("localhost", 6380, "kub_xxx")) {
    client.set("mykey", "Hello");
    
    // Expire in 60 seconds
    client.expire("mykey", 60);
    
    // Or use Duration
    client.expire("mykey", Duration.ofMinutes(1));
    
    // Expire in 5000 milliseconds
    client.pexpire("mykey", 5000);
}</code></pre>
                            </div>
                            <div class="tab-pane fade" id="expire-csharp">
<pre class="bg-dark text-light p-3 rounded"><code>using var client = new KuberClient("localhost", 6380, "kub_xxx");
await client.SetAsync("mykey", "Hello");

// Expire in 60 seconds
await client.ExpireAsync("mykey", 60);

// Or use TimeSpan
await client.ExpireAsync("mykey", TimeSpan.FromMinutes(1));

// Expire in 5000 milliseconds
await client.PExpireAsync("mykey", 5000);</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- EXPIREAT Command -->
                <div class="card mb-4">
                    <div class="card-header"><h5 class="mb-0"><code>EXPIREAT</code> / <code>PEXPIREAT</code> - Set Absolute Expiration</h5></div>
                    <div class="card-body">
                        <p>Set expiration as an absolute Unix timestamp. Useful for scheduling expiration at a specific time.</p>
                        <ul class="nav nav-tabs" role="tablist">
                            <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#expireat-redis">Redis CLI</a></li>
                            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#expireat-python">Python</a></li>
                            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#expireat-java">Java</a></li>
                            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#expireat-csharp">C#</a></li>
                        </ul>
                        <div class="tab-content mt-3">
                            <div class="tab-pane fade show active" id="expireat-redis">
<pre class="bg-dark text-light p-3 rounded"><code># Set key
SET mykey "Hello"

# Expire at specific Unix timestamp (seconds)
EXPIREAT mykey 1735689600
# Expires at Jan 1, 2025 00:00:00 UTC

# Expire at specific timestamp (milliseconds)
PEXPIREAT mykey 1735689600000</code></pre>
                            </div>
                            <div class="tab-pane fade" id="expireat-python">
<pre class="bg-dark text-light p-3 rounded"><code>import time
from datetime import datetime

with KuberRedisClient('localhost', 6380, api_key='kub_xxx') as client:
    client.set('mykey', 'Hello')
    
    # Expire at midnight tonight
    midnight = datetime.now().replace(hour=23, minute=59, second=59)
    timestamp = int(midnight.timestamp())
    client.expireat('mykey', timestamp)
    
    # Or expire in 1 hour from now
    expire_time = int(time.time()) + 3600
    client.expireat('mykey', expire_time)</code></pre>
                            </div>
                            <div class="tab-pane fade" id="expireat-java">
<pre class="bg-dark text-light p-3 rounded"><code>try (KuberClient client = new KuberClient("localhost", 6380, "kub_xxx")) {
    client.set("mykey", "Hello");
    
    // Expire at specific time
    Instant expireTime = Instant.now().plus(Duration.ofHours(1));
    client.expireAt("mykey", expireTime.getEpochSecond());
    
    // Expire at midnight
    LocalDateTime midnight = LocalDate.now().plusDays(1).atStartOfDay();
    long timestamp = midnight.toEpochSecond(ZoneOffset.UTC);
    client.expireAt("mykey", timestamp);
}</code></pre>
                            </div>
                            <div class="tab-pane fade" id="expireat-csharp">
<pre class="bg-dark text-light p-3 rounded"><code>using var client = new KuberClient("localhost", 6380, "kub_xxx");
await client.SetAsync("mykey", "Hello");

// Expire at specific time
var expireTime = DateTimeOffset.UtcNow.AddHours(1);
await client.ExpireAtAsync("mykey", expireTime.ToUnixTimeSeconds());

// Expire at midnight
var midnight = DateTime.Today.AddDays(1);
var timestamp = new DateTimeOffset(midnight).ToUnixTimeSeconds();
await client.ExpireAtAsync("mykey", timestamp);</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- PERSIST Command -->
                <div class="card mb-4">
                    <div class="card-header"><h5 class="mb-0"><code>PERSIST</code> - Remove Expiration</h5></div>
                    <div class="card-body">
                        <p>Remove the expiration from a key, making it persist indefinitely.</p>
                        <ul class="nav nav-tabs" role="tablist">
                            <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#persist-redis">Redis CLI</a></li>
                            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#persist-python">Python</a></li>
                            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#persist-java">Java</a></li>
                            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#persist-csharp">C#</a></li>
                        </ul>
                        <div class="tab-content mt-3">
                            <div class="tab-pane fade show active" id="persist-redis">
<pre class="bg-dark text-light p-3 rounded"><code># Set key with TTL
SETEX mykey 3600 "temporary"

# Check TTL
TTL mykey
# Returns: ~3600

# Remove expiration
PERSIST mykey
# Returns: 1 (success)

# Verify - now persistent
TTL mykey
# Returns: -1 (no expiry)</code></pre>
                            </div>
                            <div class="tab-pane fade" id="persist-python">
<pre class="bg-dark text-light p-3 rounded"><code>with KuberRedisClient('localhost', 6380, api_key='kub_xxx') as client:
    # Set with TTL
    client.setex('mykey', 3600, 'temporary')
    print(f"TTL before: {client.ttl('mykey')}")  # ~3600
    
    # Remove expiration
    client.persist('mykey')
    print(f"TTL after: {client.ttl('mykey')}")  # -1</code></pre>
                            </div>
                            <div class="tab-pane fade" id="persist-java">
<pre class="bg-dark text-light p-3 rounded"><code>try (KuberClient client = new KuberClient("localhost", 6380, "kub_xxx")) {
    // Set with TTL
    client.setex("mykey", 3600, "temporary");
    System.out.println("TTL before: " + client.ttl("mykey"));
    
    // Remove expiration
    client.persist("mykey");
    System.out.println("TTL after: " + client.ttl("mykey"));  // -1
}</code></pre>
                            </div>
                            <div class="tab-pane fade" id="persist-csharp">
<pre class="bg-dark text-light p-3 rounded"><code>using var client = new KuberClient("localhost", 6380, "kub_xxx");

// Set with TTL
await client.SetExAsync("mykey", 3600, "temporary");
Console.WriteLine($"TTL before: {await client.TtlAsync("mykey")}");

// Remove expiration
await client.PersistAsync("mykey");
Console.WriteLine($"TTL after: {await client.TtlAsync("mykey")}");  // -1</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SETEX/PSETEX Commands -->
                <div class="card mb-4">
                    <div class="card-header"><h5 class="mb-0"><code>SETEX</code> / <code>PSETEX</code> - Atomic Set with TTL</h5></div>
                    <div class="card-body">
                        <p>Set value and expiration atomically. Equivalent to SET + EXPIRE but in one command.</p>
                        <ul class="nav nav-tabs" role="tablist">
                            <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#setex-redis">Redis CLI</a></li>
                            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#setex-python">Python</a></li>
                            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#setex-java">Java</a></li>
                            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#setex-csharp">C#</a></li>
                        </ul>
                        <div class="tab-content mt-3">
                            <div class="tab-pane fade show active" id="setex-redis">
<pre class="bg-dark text-light p-3 rounded"><code># Set with TTL in seconds
SETEX session:abc 3600 "user_data"

# Set with TTL in milliseconds
PSETEX cache:item 60000 "cached_value"

# Equivalent to:
# SET key value
# EXPIRE key seconds
# But atomic!</code></pre>
                            </div>
                            <div class="tab-pane fade" id="setex-python">
<pre class="bg-dark text-light p-3 rounded"><code>with KuberRedisClient('localhost', 6380, api_key='kub_xxx') as client:
    # Set with TTL (seconds)
    client.setex('session:abc', 3600, 'user_data')
    
    # Set with TTL (milliseconds)
    client.psetex('cache:item', 60000, 'cached_value')
    
    # Or use set() with ttl parameter
    client.set('session:xyz', 'data', ttl=3600)</code></pre>
                            </div>
                            <div class="tab-pane fade" id="setex-java">
<pre class="bg-dark text-light p-3 rounded"><code>try (KuberClient client = new KuberClient("localhost", 6380, "kub_xxx")) {
    // Set with TTL (seconds)
    client.setex("session:abc", 3600, "user_data");
    
    // Set with TTL (milliseconds)
    client.psetex("cache:item", 60000, "cached_value");
    
    // Or use set() with Duration
    client.set("session:xyz", "data", Duration.ofHours(1));
}</code></pre>
                            </div>
                            <div class="tab-pane fade" id="setex-csharp">
<pre class="bg-dark text-light p-3 rounded"><code>using var client = new KuberClient("localhost", 6380, "kub_xxx");

// Set with TTL (seconds)
await client.SetExAsync("session:abc", 3600, "user_data");

// Set with TTL (milliseconds)
await client.PSetExAsync("cache:item", 60000, "cached_value");

// Or use SetAsync with TimeSpan
await client.SetAsync("session:xyz", "data", TimeSpan.FromHours(1));</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="alert alert-info">
                    <i class="fas fa-lightbulb me-2"></i>
                    <strong>Best Practice:</strong> Use SETEX/PSETEX when setting a value with TTL. It's atomic and more efficient than SET followed by EXPIRE.
                </div>

                <div class="mt-5 text-center">
                    <a href="/help/key-ops" class="btn btn-outline-secondary"><i class="fas fa-arrow-left me-2"></i>Key Operations</a>
                    <a href="/help" class="btn btn-outline-primary ms-2">Help Index</a>
                    <a href="/help/hash-ops" class="btn btn-outline-secondary ms-2">Hash Operations <i class="fas fa-arrow-right ms-2"></i></a>
                </div>
            </div>
        </div>
        <footer class="py-4 mt-5 border-top">
            <div class="row">
                <div class="col-md-6"><h6><i class="fas fa-database me-2"></i><span th:text="${appName} ?: 'Kuber'">Kuber</span></h6><p class="text-muted small mb-0">Version 2.6.0</p></div>
                <div class="col-md-6 text-end"><p class="text-muted small mb-0">Copyright &copy; 2025-2030 Ashutosh Sinha<br><span class="badge bg-warning text-dark">Patent Pending</span></p></div>
            </div>
        </footer>
    </div>
</main>
<footer th:replace="~{layout :: footer}"></footer>
<th:block th:replace="~{layout :: scripts}"></th:block>
</body>
</html>
