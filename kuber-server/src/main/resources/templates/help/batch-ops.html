<!DOCTYPE html>
<!--
  ~ Copyright Â© 2025-2030, All Rights Reserved
  ~ Ashutosh Sinha | Email: ajsinha@gmail.com
  ~ Patent Pending
  -->
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{layout :: head('Batch Operations')}"></head>
<body class="d-flex flex-column min-vh-100">
<nav th:replace="~{layout :: navbar}"></nav>
<main class="flex-fill">
    <div class="container-fluid py-4">
        <nav aria-label="breadcrumb" class="mb-4">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="/help"><i class="fas fa-book me-1"></i>Help</a></li>
                <li class="breadcrumb-item active">Batch Operations</li>
            </ol>
        </nav>
        <div class="row">
            <div class="col-lg-11 mx-auto">
                <h1 class="display-5 mb-4"><i class="fas fa-layer-group text-purple me-3" style="color: #6f42c1;"></i>Batch Operations</h1>
                
                <p class="lead">Batch operations let you get or set multiple keys in a single request, significantly improving performance for bulk operations.</p>

                <!-- Command Reference Table -->
                <div class="card mb-4">
                    <div class="card-header" style="background-color: #6f42c1; color: white;">
                        <h5 class="mb-0"><i class="fas fa-list me-2"></i>Command Reference</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead class="table-dark">
                                    <tr><th>Command</th><th>Syntax</th><th>Description</th></tr>
                                </thead>
                                <tbody>
                                    <tr><td><code>MGET</code></td><td><code>MGET key [key ...]</code></td><td>Get values of multiple keys in one call</td></tr>
                                    <tr><td><code>MSET</code></td><td><code>MSET key value [key value ...]</code></td><td>Set multiple key-value pairs atomically</td></tr>
                                    <tr><td><code>MSETNX</code></td><td><code>MSETNX key value [key value ...]</code></td><td>Set multiple keys only if none exist</td></tr>
                                    <tr><td><code>DEL</code></td><td><code>DEL key [key ...]</code></td><td>Delete multiple keys</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- MGET Command -->
                <div class="card mb-4">
                    <div class="card-header"><h5 class="mb-0"><code>MGET</code> - Get Multiple Keys</h5></div>
                    <div class="card-body">
                        <p>Get the values of multiple keys in a single request. Returns nil for keys that don't exist.</p>
                        <ul class="nav nav-tabs" role="tablist">
                            <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#mget-redis">Redis CLI</a></li>
                            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#mget-python">Python</a></li>
                            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#mget-java">Java</a></li>
                            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#mget-csharp">C#</a></li>
                        </ul>
                        <div class="tab-content mt-3">
                            <div class="tab-pane fade show active" id="mget-redis">
<pre class="bg-dark text-light p-3 rounded"><code># Set some keys first
SET user:1001 "Alice"
SET user:1002 "Bob"
SET user:1003 "Charlie"

# Get multiple keys
MGET user:1001 user:1002 user:1003 user:9999
# Returns: ["Alice", "Bob", "Charlie", nil]

# Order is preserved - nil for missing keys</code></pre>
                            </div>
                            <div class="tab-pane fade" id="mget-python">
<pre class="bg-dark text-light p-3 rounded"><code>with KuberRedisClient('localhost', 6380, api_key='kub_xxx') as client:
    # Set some keys
    client.set('user:1001', 'Alice')
    client.set('user:1002', 'Bob')
    client.set('user:1003', 'Charlie')
    
    # Get multiple keys at once
    values = client.mget('user:1001', 'user:1002', 'user:1003', 'user:9999')
    print(f"Values: {values}")
    # ['Alice', 'Bob', 'Charlie', None]
    
    # Or use list
    keys = ['user:1001', 'user:1002', 'user:1003']
    values = client.mget(*keys)</code></pre>
                            </div>
                            <div class="tab-pane fade" id="mget-java">
<pre class="bg-dark text-light p-3 rounded"><code>try (KuberClient client = new KuberClient("localhost", 6380, "kub_xxx")) {
    // Set some keys
    client.set("user:1001", "Alice");
    client.set("user:1002", "Bob");
    client.set("user:1003", "Charlie");
    
    // Get multiple keys at once
    List&lt;String&gt; values = client.mget("user:1001", "user:1002", "user:1003", "user:9999");
    System.out.println("Values: " + values);
    // [Alice, Bob, Charlie, null]
    
    // Or use List
    List&lt;String&gt; keys = Arrays.asList("user:1001", "user:1002", "user:1003");
    values = client.mget(keys.toArray(new String[0]));
}</code></pre>
                            </div>
                            <div class="tab-pane fade" id="mget-csharp">
<pre class="bg-dark text-light p-3 rounded"><code>using var client = new KuberClient("localhost", 6380, "kub_xxx");

// Set some keys
await client.SetAsync("user:1001", "Alice");
await client.SetAsync("user:1002", "Bob");
await client.SetAsync("user:1003", "Charlie");

// Get multiple keys at once
var values = await client.MGetAsync("user:1001", "user:1002", "user:1003", "user:9999");
Console.WriteLine($"Values: {string.Join(", ", values)}");
// Alice, Bob, Charlie, null

// Or use array
var keys = new[] { "user:1001", "user:1002", "user:1003" };
values = await client.MGetAsync(keys);</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- MSET Command -->
                <div class="card mb-4">
                    <div class="card-header"><h5 class="mb-0"><code>MSET</code> - Set Multiple Keys</h5></div>
                    <div class="card-body">
                        <p>Set multiple key-value pairs in a single atomic operation. Always succeeds.</p>
                        <ul class="nav nav-tabs" role="tablist">
                            <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#mset-redis">Redis CLI</a></li>
                            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#mset-python">Python</a></li>
                            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#mset-java">Java</a></li>
                            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#mset-csharp">C#</a></li>
                        </ul>
                        <div class="tab-content mt-3">
                            <div class="tab-pane fade show active" id="mset-redis">
<pre class="bg-dark text-light p-3 rounded"><code># Set multiple keys at once
MSET user:1001 "Alice" user:1002 "Bob" user:1003 "Charlie"
# Returns: OK

# All keys are set atomically
# If one fails, none are set

# Verify
MGET user:1001 user:1002 user:1003
# Returns: ["Alice", "Bob", "Charlie"]</code></pre>
                            </div>
                            <div class="tab-pane fade" id="mset-python">
<pre class="bg-dark text-light p-3 rounded"><code>with KuberRedisClient('localhost', 6380, api_key='kub_xxx') as client:
    # Set multiple keys using dict
    client.mset({
        'user:1001': 'Alice',
        'user:1002': 'Bob',
        'user:1003': 'Charlie',
        'config:app': 'production'
    })
    
    # Verify
    values = client.mget('user:1001', 'user:1002', 'user:1003')
    print(f"Values: {values}")  # ['Alice', 'Bob', 'Charlie']</code></pre>
                            </div>
                            <div class="tab-pane fade" id="mset-java">
<pre class="bg-dark text-light p-3 rounded"><code>try (KuberClient client = new KuberClient("localhost", 6380, "kub_xxx")) {
    // Set multiple keys using Map
    Map&lt;String, String&gt; keyValues = new HashMap&lt;&gt;();
    keyValues.put("user:1001", "Alice");
    keyValues.put("user:1002", "Bob");
    keyValues.put("user:1003", "Charlie");
    keyValues.put("config:app", "production");
    
    client.mset(keyValues);
    
    // Verify
    List&lt;String&gt; values = client.mget("user:1001", "user:1002", "user:1003");
    System.out.println("Values: " + values);
}</code></pre>
                            </div>
                            <div class="tab-pane fade" id="mset-csharp">
<pre class="bg-dark text-light p-3 rounded"><code>using var client = new KuberClient("localhost", 6380, "kub_xxx");

// Set multiple keys using Dictionary
var keyValues = new Dictionary&lt;string, string&gt; {
    ["user:1001"] = "Alice",
    ["user:1002"] = "Bob",
    ["user:1003"] = "Charlie",
    ["config:app"] = "production"
};

await client.MSetAsync(keyValues);

// Verify
var values = await client.MGetAsync("user:1001", "user:1002", "user:1003");
Console.WriteLine($"Values: {string.Join(", ", values)}");</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- MSETNX Command -->
                <div class="card mb-4">
                    <div class="card-header"><h5 class="mb-0"><code>MSETNX</code> - Set Multiple Keys If None Exist</h5></div>
                    <div class="card-body">
                        <p>Set multiple keys only if <strong>none</strong> of them exist. Atomic all-or-nothing operation.</p>
                        <ul class="nav nav-tabs" role="tablist">
                            <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#msetnx-redis">Redis CLI</a></li>
                            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#msetnx-python">Python</a></li>
                            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#msetnx-java">Java</a></li>
                            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#msetnx-csharp">C#</a></li>
                        </ul>
                        <div class="tab-content mt-3">
                            <div class="tab-pane fade show active" id="msetnx-redis">
<pre class="bg-dark text-light p-3 rounded"><code># First call - all keys are new
MSETNX newkey1 "value1" newkey2 "value2" newkey3 "value3"
# Returns: 1 (success - all keys set)

# Second call - some keys exist
MSETNX newkey1 "updated" newkey4 "value4"
# Returns: 0 (failed - newkey1 exists, NONE set)

# newkey4 was NOT set because newkey1 existed
GET newkey4
# Returns: (nil)</code></pre>
                            </div>
                            <div class="tab-pane fade" id="msetnx-python">
<pre class="bg-dark text-light p-3 rounded"><code>with KuberRedisClient('localhost', 6380, api_key='kub_xxx') as client:
    # First call - success
    result = client.msetnx({
        'newkey1': 'value1',
        'newkey2': 'value2',
        'newkey3': 'value3'
    })
    print(f"First MSETNX: {result}")  # True
    
    # Second call - fails (newkey1 exists)
    result = client.msetnx({
        'newkey1': 'updated',
        'newkey4': 'value4'
    })
    print(f"Second MSETNX: {result}")  # False (nothing set)</code></pre>
                            </div>
                            <div class="tab-pane fade" id="msetnx-java">
<pre class="bg-dark text-light p-3 rounded"><code>try (KuberClient client = new KuberClient("localhost", 6380, "kub_xxx")) {
    // First call - success
    Map&lt;String, String&gt; first = Map.of(
        "newkey1", "value1",
        "newkey2", "value2",
        "newkey3", "value3"
    );
    boolean result = client.msetnx(first);
    System.out.println("First MSETNX: " + result);  // true
    
    // Second call - fails (newkey1 exists)
    Map&lt;String, String&gt; second = Map.of(
        "newkey1", "updated",
        "newkey4", "value4"
    );
    result = client.msetnx(second);
    System.out.println("Second MSETNX: " + result);  // false
}</code></pre>
                            </div>
                            <div class="tab-pane fade" id="msetnx-csharp">
<pre class="bg-dark text-light p-3 rounded"><code>using var client = new KuberClient("localhost", 6380, "kub_xxx");

// First call - success
var first = new Dictionary&lt;string, string&gt; {
    ["newkey1"] = "value1",
    ["newkey2"] = "value2",
    ["newkey3"] = "value3"
};
bool result = await client.MSetNxAsync(first);
Console.WriteLine($"First MSETNX: {result}");  // true

// Second call - fails (newkey1 exists)
var second = new Dictionary&lt;string, string&gt; {
    ["newkey1"] = "updated",
    ["newkey4"] = "value4"
};
result = await client.MSetNxAsync(second);
Console.WriteLine($"Second MSETNX: {result}");  // false</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- DEL Multiple Keys -->
                <div class="card mb-4">
                    <div class="card-header"><h5 class="mb-0"><code>DEL</code> - Delete Multiple Keys</h5></div>
                    <div class="card-body">
                        <p>Delete multiple keys in a single operation. Returns the number of keys deleted.</p>
                        <ul class="nav nav-tabs" role="tablist">
                            <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#del-redis">Redis CLI</a></li>
                            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#del-python">Python</a></li>
                            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#del-java">Java</a></li>
                            <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#del-csharp">C#</a></li>
                        </ul>
                        <div class="tab-content mt-3">
                            <div class="tab-pane fade show active" id="del-redis">
<pre class="bg-dark text-light p-3 rounded"><code># Delete multiple keys
DEL user:1001 user:1002 user:1003 nonexistent
# Returns: 3 (only existing keys counted)

# Useful pattern: delete by pattern (two-step)
# 1. Get keys
KEYS session:*
# 2. Delete them
DEL session:abc session:def session:ghi</code></pre>
                            </div>
                            <div class="tab-pane fade" id="del-python">
<pre class="bg-dark text-light p-3 rounded"><code>with KuberRedisClient('localhost', 6380, api_key='kub_xxx') as client:
    # Delete multiple keys
    deleted = client.delete('user:1001', 'user:1002', 'user:1003')
    print(f"Deleted: {deleted}")  # 3
    
    # Delete by pattern (two-step)
    keys = client.keys('session:*')
    if keys:
        deleted = client.delete(*keys)
        print(f"Deleted {deleted} session keys")</code></pre>
                            </div>
                            <div class="tab-pane fade" id="del-java">
<pre class="bg-dark text-light p-3 rounded"><code>try (KuberClient client = new KuberClient("localhost", 6380, "kub_xxx")) {
    // Delete multiple keys
    long deleted = client.del("user:1001", "user:1002", "user:1003");
    System.out.println("Deleted: " + deleted);  // 3
    
    // Delete by pattern (two-step)
    Set&lt;String&gt; keys = client.keys("session:*");
    if (!keys.isEmpty()) {
        deleted = client.del(keys.toArray(new String[0]));
        System.out.println("Deleted " + deleted + " session keys");
    }
}</code></pre>
                            </div>
                            <div class="tab-pane fade" id="del-csharp">
<pre class="bg-dark text-light p-3 rounded"><code>using var client = new KuberClient("localhost", 6380, "kub_xxx");

// Delete multiple keys
long deleted = await client.DeleteAsync("user:1001", "user:1002", "user:1003");
Console.WriteLine($"Deleted: {deleted}");  // 3

// Delete by pattern (two-step)
var keys = client.Keys("session:*").ToArray();
if (keys.Length > 0) {
    deleted = await client.DeleteAsync(keys);
    Console.WriteLine($"Deleted {deleted} session keys");
}</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Performance Tips -->
                <div class="card mb-4">
                    <div class="card-header bg-info text-white">
                        <h5 class="mb-0"><i class="fas fa-tachometer-alt me-2"></i>Performance Tips</h5>
                    </div>
                    <div class="card-body">
                        <ul>
                            <li><strong>Use batch operations</strong> instead of multiple single calls to reduce network round-trips</li>
                            <li><strong>MGET/MSET</strong> are significantly faster than looping over individual GET/SET calls</li>
                            <li><strong>Optimal batch size:</strong> 100-1000 keys per batch for best performance</li>
                            <li><strong>Messaging limits:</strong> When using request/response messaging, batch operations are limited by <code>max_batch_get_size</code> and <code>max_batch_set_size</code> (default: 128)</li>
                        </ul>
                        
                        <h6 class="mt-4">Example: Batch Loading</h6>
                        <pre class="bg-dark text-light p-3 rounded"><code># Python - efficiently load 10,000 keys
def batch_load(client, key_values, batch_size=500):
    items = list(key_values.items())
    for i in range(0, len(items), batch_size):
        batch = dict(items[i:i+batch_size])
        client.mset(batch)
        print(f"Loaded {min(i+batch_size, len(items))}/{len(items)}")</code></pre>
                    </div>
                </div>

                <div class="mt-5 text-center">
                    <a href="/help/hash-ops" class="btn btn-outline-secondary"><i class="fas fa-arrow-left me-2"></i>Hash Operations</a>
                    <a href="/help" class="btn btn-outline-primary ms-2">Help Index</a>
                    <a href="/help/json-ops" class="btn btn-outline-secondary ms-2">JSON Operations <i class="fas fa-arrow-right ms-2"></i></a>
                </div>
            </div>
        </div>
        <footer class="py-4 mt-5 border-top">
            <div class="row">
                <div class="col-md-6"><h6><i class="fas fa-database me-2"></i><span th:text="${appName} ?: 'Kuber'">Kuber</span></h6><p class="text-muted small mb-0">Version 2.5.0</p></div>
                <div class="col-md-6 text-end"><p class="text-muted small mb-0">Copyright &copy; 2025-2030 Ashutosh Sinha<br><span class="badge bg-warning text-dark">Patent Pending</span></p></div>
            </div>
        </footer>
    </div>
</main>
<th:block th:replace="~{layout :: scripts}"></th:block>
</body>
</html>
