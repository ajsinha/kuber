<!DOCTYPE html>
<!--
  ~ Copyright © 2025-2030, All Rights Reserved
  ~ Ashutosh Sinha | Email: ajsinha@gmail.com
  ~ Patent Pending
  -->
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{layout :: head('Java Client')}"></head>
<body class="d-flex flex-column min-vh-100">

<nav th:replace="~{layout :: navbar}"></nav>

<main class="flex-fill">
    <div class="container-fluid py-4">
        <!-- Breadcrumb -->
        <nav aria-label="breadcrumb" class="mb-4">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="/help"><i class="fas fa-book me-1"></i>Help</a></li>
                <li class="breadcrumb-item active" aria-current="page">Java Client</li>
            </ol>
        </nav>

        <!-- Content -->
        <div class="row">
            <div class="col-lg-10 mx-auto">
                <h1 class="display-5 mb-4"><i class="fab fa-java me-3 text-danger"></i>Java Client</h1>
                
                <div class="alert alert-warning">
                    <i class="fas fa-key me-2"></i>
                    <strong>v1.6.5: API Key Authentication Required</strong><br>
                    All programmatic access requires an API key. Create one in <a href="/admin/apikeys">Admin → API Keys</a>.
                </div>

                <!-- Table of Contents -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="fas fa-list me-2"></i>Contents</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <ul class="list-unstyled mb-0">
                                    <li><a href="#redis-client">Redis Protocol Client</a></li>
                                    <li><a href="#rest-client">REST API Client</a></li>
                                    <li><a href="#jedis">Using Jedis</a></li>
                                    <li><a href="#json-ops">JSON Operations</a></li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <ul class="list-unstyled mb-0">
                                    <li><a href="#standalone">Standalone Client Files</a></li>
                                    <li><a href="#regions">Region Management</a></li>
                                    <li><a href="#messaging">Request/Response Messaging</a> <span class="badge bg-success">v1.7.1</span></li>
                                    <li><a href="#complete-example">Complete Example</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Redis Protocol Client -->
                <section id="redis-client" class="mb-5">
                    <h3 class="border-bottom pb-2"><i class="fas fa-plug me-2"></i>Redis Protocol Client (KuberClient)</h3>
                    
                    <h4>Maven Dependency</h4>
                    <pre class="bg-dark text-light p-3 rounded"><code>&lt;dependency&gt;
    &lt;groupId&gt;com.kuber&lt;/groupId&gt;
    &lt;artifactId&gt;kuber-client-java&lt;/artifactId&gt;
    &lt;version&gt;1.7.1-SNAPSHOT&lt;/version&gt;
&lt;/dependency&gt;</code></pre>

                    <h4 class="mt-4">Basic Usage</h4>
                    <pre class="bg-dark text-light p-3 rounded"><code>import com.kuber.client.KuberClient;

public class KuberExample {
    public static void main(String[] args) throws Exception {
        // API Key required (get from Admin → API Keys)
        String apiKey = "kub_your_api_key_here";
        
        try (KuberClient client = new KuberClient("localhost", 6380, apiKey)) {
            // Test connection
            System.out.println("PING: " + client.ping());
            
            // String operations
            client.set("user:1001", "John Doe");
            String name = client.get("user:1001");
            System.out.println("User: " + name);
            
            // Set with TTL (30 minutes)
            client.set("session:abc", "session-data", Duration.ofMinutes(30));
            
            // Check TTL
            long ttl = client.ttl("session:abc");
            System.out.println("TTL: " + ttl + " seconds");
            
            // Delete
            client.delete("user:1001");
        }
    }
}</code></pre>

                    <h4 class="mt-4">Constructor Options</h4>
                    <pre class="bg-dark text-light p-3 rounded"><code>// Basic - API key required
KuberClient client = new KuberClient("localhost", 6380, "kub_xxx");

// With custom timeout (5 minutes)
KuberClient client = new KuberClient("localhost", 6380, "kub_xxx", 300000);</code></pre>
                </section>

                <!-- REST API Client -->
                <section id="rest-client" class="mb-5">
                    <h3 class="border-bottom pb-2"><i class="fas fa-cloud me-2"></i>REST API Client (KuberRestClient)</h3>
                    
                    <h4>Basic Usage</h4>
                    <pre class="bg-dark text-light p-3 rounded"><code>import com.kuber.client.KuberRestClient;

public class RestExample {
    public static void main(String[] args) throws Exception {
        // API Key required (get from Admin → API Keys)
        String apiKey = "kub_your_api_key_here";
        
        KuberRestClient client = new KuberRestClient("localhost", 8080, apiKey);
        
        // Server info
        System.out.println("Info: " + client.info());
        
        // String operations
        client.set("key1", "value1");
        String value = client.get("key1");
        System.out.println("Value: " + value);
        
        // Set with TTL (1 hour = 3600 seconds)
        client.set("temp:key", "temp-value", 3600);
        
        client.close();
    }
}</code></pre>

                    <h4 class="mt-4">Constructor Options</h4>
                    <pre class="bg-dark text-light p-3 rounded"><code>// Basic - API key required
KuberRestClient client = new KuberRestClient("localhost", 8080, "kub_xxx");

// With SSL
KuberRestClient client = new KuberRestClient("localhost", 8443, "kub_xxx", true);

// With SSL and custom timeout
KuberRestClient client = new KuberRestClient("localhost", 8443, "kub_xxx", true, 60000);</code></pre>
                </section>

                <!-- Using Jedis -->
                <section id="jedis" class="mb-5">
                    <h3 class="border-bottom pb-2"><i class="fas fa-terminal me-2"></i>Using Jedis</h3>
                    
                    <h4>Maven Dependency</h4>
                    <pre class="bg-dark text-light p-3 rounded"><code>&lt;dependency&gt;
    &lt;groupId&gt;redis.clients&lt;/groupId&gt;
    &lt;artifactId&gt;jedis&lt;/artifactId&gt;
    &lt;version&gt;5.1.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>

                    <h4 class="mt-4">Basic Usage with API Key</h4>
                    <pre class="bg-dark text-light p-3 rounded"><code>import redis.clients.jedis.Jedis;

public class JedisExample {
    public static void main(String[] args) {
        String apiKey = "kub_your_api_key_here";
        
        try (Jedis jedis = new Jedis("localhost", 6380)) {
            // Authenticate with API key
            jedis.auth(apiKey);
            
            // Now use normally
            jedis.set("key", "value");
            String value = jedis.get("key");
            System.out.println("Value: " + value);
        }
    }
}</code></pre>
                </section>

                <!-- JSON Operations -->
                <section id="json-ops" class="mb-5">
                    <h3 class="border-bottom pb-2"><i class="fas fa-code me-2"></i>JSON Operations</h3>
                    
                    <pre class="bg-dark text-light p-3 rounded"><code>try (KuberClient client = new KuberClient("localhost", 6380, "kub_xxx")) {
    // Store JSON document
    Map&lt;String, Object&gt; user = new HashMap&lt;&gt;();
    user.put("name", "John Doe");
    user.put("age", 30);
    user.put("status", "active");
    user.put("email", "john@company.com");
    user.put("temp", "temporary_field");
    
    client.jsonSet("user:1001", user);
    
    // Get JSON document
    JsonNode retrieved = client.jsonGet("user:1001");
    System.out.println("User: " + retrieved);
    
    // Get specific path
    JsonNode name = client.jsonGet("user:1001", "$.name");
    System.out.println("Name: " + name);
    
    // Update/merge JSON (new in v1.7.2) - upsert with deep merge
    // Adds new fields, updates existing fields
    JsonNode updated = client.jsonUpdate("user:1001", "{\"age\": 31, \"city\": \"NYC\"}");
    System.out.println("After merge: " + updated);
    // Result: {"name":"John Doe","age":31,"status":"active","email":"...","city":"NYC","temp":"..."}
    
    // Remove attributes from JSON (new in v1.7.2)
    // Using varargs
    JsonNode afterRemove = client.jsonRemove("user:1001", "temp", "city");
    System.out.println("After remove: " + afterRemove);
    // Result: {"name":"John Doe","age":31,"status":"active","email":"..."}
    
    // Or using List
    JsonNode result = client.jsonRemove("user:1001", Arrays.asList("field1", "field2"));
    
    // Search JSON documents
    List&lt;JsonNode&gt; activeUsers = client.jsonSearch("$.status=active");
    System.out.println("Active users: " + activeUsers.size());
}</code></pre>

                    <h4 class="mt-4">JSON Command Summary</h4>
                    <div class="table-responsive">
                        <table class="table table-bordered table-striped">
                            <thead class="table-dark">
                                <tr>
                                    <th>Method</th>
                                    <th>Description</th>
                                    <th>Example</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>jsonSet(key, json)</code></td>
                                    <td>Store JSON document</td>
                                    <td><code>client.jsonSet("user:1", "{\"name\":\"Alice\"}")</code></td>
                                </tr>
                                <tr>
                                    <td><code>jsonGet(key, path)</code></td>
                                    <td>Get JSON document or path</td>
                                    <td><code>client.jsonGet("user:1", "$.name")</code></td>
                                </tr>
                                <tr>
                                    <td><code>jsonUpdate(key, json)</code></td>
                                    <td>Merge JSON (upsert, deep merge)</td>
                                    <td><code>client.jsonUpdate("user:1", "{\"age\":31}")</code></td>
                                </tr>
                                <tr>
                                    <td><code>jsonRemove(key, attrs...)</code></td>
                                    <td>Remove attributes from JSON</td>
                                    <td><code>client.jsonRemove("user:1", "age", "temp")</code></td>
                                </tr>
                                <tr>
                                    <td><code>jsonDelete(key, path)</code></td>
                                    <td>Delete JSON document or path</td>
                                    <td><code>client.jsonDelete("user:1")</code></td>
                                </tr>
                                <tr>
                                    <td><code>jsonSearch(query)</code></td>
                                    <td>Search JSON documents</td>
                                    <td><code>client.jsonSearch("$.age&gt;25")</code></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h4 class="mt-4">JSON Search Operators</h4>
                    <div class="table-responsive">
                        <table class="table table-bordered table-striped">
                            <thead class="table-dark">
                                <tr>
                                    <th>Operator</th>
                                    <th>Example</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td><code>=</code> or <code>==</code></td><td><code>$.status=active</code></td><td>Exact match</td></tr>
                                <tr><td><code>!=</code> or <code>&lt;&gt;</code></td><td><code>$.status!=inactive</code></td><td>Not equal</td></tr>
                                <tr><td><code>&gt;</code></td><td><code>$.age&gt;25</code></td><td>Greater than</td></tr>
                                <tr><td><code>&lt;</code></td><td><code>$.price&lt;100</code></td><td>Less than</td></tr>
                                <tr><td><code>&gt;=</code></td><td><code>$.salary&gt;=50000</code></td><td>Greater or equal</td></tr>
                                <tr><td><code>&lt;=</code></td><td><code>$.stock&lt;=10</code></td><td>Less or equal</td></tr>
                                <tr class="table-info"><td><code>~=</code></td><td><code>$.email~=.*@company\\.com</code></td><td><strong>Regex match</strong></td></tr>
                                <tr><td><code>contains</code></td><td><code>$.name contains John</code></td><td>Substring match</td></tr>
                                <tr><td><code>startsWith</code></td><td><code>$.name startsWith J</code></td><td>Prefix match</td></tr>
                                <tr><td><code>endsWith</code></td><td><code>$.name endsWith son</code></td><td>Suffix match</td></tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <h5 class="mt-3">Regex Search Examples</h5>
                    <pre class="bg-dark text-light p-3 rounded"><code>// Find users with company email
List&lt;JsonNode&gt; results = client.jsonSearch("$.email~=.*@company\\.com");

// Find names starting with 'J'
results = client.jsonSearch("$.name~=^J.*");

// Find 5-digit zip codes
results = client.jsonSearch("$.address.zip~=\\d{5}");

// Combined search: Engineering dept AND name contains Smith
results = client.jsonSearch("$.department=Engineering,$.name~=.*Smith.*");</code></pre>
                </section>

                <!-- Standalone Files -->
                <section id="standalone" class="mb-5">
                    <h3 class="border-bottom pb-2"><i class="fas fa-file-code me-2"></i>Standalone Client Files</h3>
                    <p>Ready-to-use standalone Java files in the client module:</p>
                    
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <div class="card h-100">
                                <div class="card-header bg-danger text-white">
                                    <i class="fas fa-plug me-2"></i>Redis Protocol
                                </div>
                                <div class="card-body">
                                    <h6>KuberClient.java</h6>
                                    <p class="small text-muted">Full-featured Redis protocol client with all operations.</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <div class="card h-100">
                                <div class="card-header bg-success text-white">
                                    <i class="fas fa-cloud me-2"></i>REST API
                                </div>
                                <div class="card-body">
                                    <h6>KuberRestClient.java</h6>
                                    <p class="small text-muted">HTTP REST client using java.net.HttpURLConnection.</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <div class="card h-100">
                                <div class="card-header bg-info text-white">
                                    <i class="fas fa-search me-2"></i>JSON Demo
                                </div>
                                <div class="card-body">
                                    <h6>KuberJsonDemo.java</h6>
                                    <p class="small text-muted">Demonstrates all JSON operations and search.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <h5 class="mt-3">Example Files</h5>
                    <pre class="bg-dark text-light p-3 rounded"><code>kuber-client-java/
├── src/main/java/com/kuber/client/
│   ├── KuberClient.java          # Redis protocol client
│   ├── KuberRestClient.java      # REST API client
│   └── examples/
│       ├── KuberJsonDemo.java    # JSON operations demo
│       ├── KuberRedisExample.java # Redis protocol examples
│       └── KuberRestExample.java  # REST API examples
├── pom.xml
└── README.md</code></pre>

                    <h5 class="mt-3">Running Examples</h5>
                    <pre class="bg-dark text-light p-3 rounded"><code># Build the client
cd kuber-client-java
mvn clean package

# Run JSON demo
java -cp target/kuber-client-java-1.7.1.jar \
    com.kuber.client.examples.KuberJsonDemo localhost 6380 kub_your_api_key

# Run Redis example
java -cp target/kuber-client-java-1.7.1.jar \
    com.kuber.client.examples.KuberRedisExample localhost 6380 kub_your_api_key

# Run REST example
java -cp target/kuber-client-java-1.7.1.jar \
    com.kuber.client.examples.KuberRestExample localhost 8080 kub_your_api_key

# Run Messaging example (v1.7.1)
java -cp target/kuber-client-java-1.7.1.jar \
    com.kuber.client.examples.KuberMessagingExample</code></pre>
                    
                    <div class="alert alert-secondary mt-3">
                        <i class="fas fa-folder-open me-2"></i>
                        <strong>Location:</strong> <code>kuber-client-java/</code> directory in the distribution archive.
                    </div>
                </section>

                <!-- Region Management -->
                <section id="regions" class="mb-5">
                    <h3 class="border-bottom pb-2"><i class="fas fa-database me-2"></i>Region Management</h3>
                    
                    <pre class="bg-dark text-light p-3 rounded"><code>try (KuberClient client = new KuberClient("localhost", 6380, "kub_xxx")) {
    // List regions
    List&lt;String&gt; regions = client.listRegions();
    System.out.println("Regions: " + regions);
    
    // Create a new region
    client.createRegion("sessions", "User session storage");
    
    // Select region
    client.selectRegion("sessions");
    
    // All operations now apply to 'sessions' region
    client.set("sess:abc123", "session-data");
    
    // Switch back to default
    client.selectRegion("default");
}</code></pre>
                </section>

                <!-- Messaging Section -->
                <section id="messaging" class="mb-5">
                    <h3 class="border-bottom pb-2"><i class="fas fa-exchange-alt me-2"></i>Request/Response Messaging <span class="badge bg-success">v1.7.1</span></h3>
                    <p>Access Kuber cache via message brokers (Kafka, RabbitMQ, IBM MQ, ActiveMQ).</p>
                    
                    <h4>Message Format</h4>
                    <pre class="bg-dark text-light p-3 rounded"><code>import com.fasterxml.jackson.databind.ObjectMapper;
import java.util.*;

ObjectMapper mapper = new ObjectMapper();

// Build a request message
Map&lt;String, Object&gt; request = new HashMap&lt;&gt;();
request.put("api_key", "kub_your_api_key");
request.put("message_id", UUID.randomUUID().toString());
request.put("operation", "GET");
request.put("region", "default");
request.put("key", "user:1001");

// Send to your broker's request topic (e.g., kuber_request)
String messageJson = mapper.writeValueAsString(request);

// Response will arrive on kuber_response topic:
// {
//   "request": { ... original request ... },
//   "response": {
//     "success": true,
//     "result": "{\"name\": \"John\"}",
//     "error": ""
//   },
//   "processing_time_ms": 2
// }</code></pre>

                    <h4 class="mt-4">Supported Operations</h4>
                    <div class="table-responsive">
                        <table class="table table-sm table-bordered">
                            <thead class="table-light">
                                <tr><th>Operation</th><th>Required Fields</th><th>Description</th></tr>
                            </thead>
                            <tbody>
                                <tr><td>GET</td><td>key</td><td>Get value by key</td></tr>
                                <tr><td>SET</td><td>key, value</td><td>Set key-value (optional: ttl)</td></tr>
                                <tr><td>DELETE</td><td>key</td><td>Delete key</td></tr>
                                <tr><td>MGET</td><td>keys[]</td><td>Get multiple keys</td></tr>
                                <tr><td>MSET</td><td>entries{}</td><td>Set multiple key-value pairs</td></tr>
                                <tr><td>KEYS</td><td>pattern</td><td>Find keys by pattern</td></tr>
                                <tr><td>JSET</td><td>key, value</td><td>Set JSON document</td></tr>
                                <tr><td>JGET</td><td>key</td><td>Get JSON document</td></tr>
                                <tr><td>JSEARCH</td><td>query</td><td>Search JSON documents</td></tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="alert alert-info mt-3">
                        <i class="fas fa-book me-2"></i>
                        See the <a href="/help/messaging" class="alert-link">Request/Response Messaging</a> help page for complete documentation on message format, broker configuration, and backpressure management.
                    </div>
                </section>

                <!-- Complete Example -->
                <section id="complete-example" class="mb-5">
                    <h3 class="border-bottom pb-2"><i class="fas fa-code me-2"></i>Complete Example</h3>
                    
                    <pre class="bg-dark text-light p-3 rounded"><code>import com.kuber.client.KuberClient;
import java.time.Duration;
import java.util.*;

public class KuberCompleteExample {
    
    // Get API key from environment or config
    private static final String API_KEY = System.getenv("KUBER_API_KEY");
    
    public static void main(String[] args) {
        if (API_KEY == null || !API_KEY.startsWith("kub_")) {
            System.err.println("Set KUBER_API_KEY environment variable");
            System.exit(1);
        }
        
        try (KuberClient client = new KuberClient("localhost", 6380, API_KEY)) {
            System.out.println("Connected: " + client.ping());
            
            // Create region for users
            client.createRegion("users", "User data");
            client.selectRegion("users");
            
            // Store user as JSON
            Map&lt;String, Object&gt; user = new HashMap&lt;&gt;();
            user.put("name", "John Doe");
            user.put("email", "john@example.com");
            user.put("age", 30);
            user.put("status", "active");
            
            client.jsonSet("user:1001", user);
            System.out.println("User stored");
            
            // Search for active users
            List&lt;Map&lt;String, Object&gt;&gt; activeUsers = client.jsonSearch("$.status=active");
            System.out.println("Found " + activeUsers.size() + " active users");
            
            // Hash operations
            client.hset("profile:1001", "visits", "42");
            client.hincrBy("profile:1001", "visits", 1);
            String visits = client.hget("profile:1001", "visits");
            System.out.println("Visits: " + visits);
            
            // Clean up
            client.delete("user:1001", "profile:1001");
            
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}</code></pre>
                </section>

                <!-- Authentication Note -->
                <div class="alert alert-info">
                    <h5><i class="fas fa-info-circle me-2"></i>Getting an API Key</h5>
                    <ol class="mb-0">
                        <li>Log into the <a href="/login">Kuber Web UI</a> with your username/password</li>
                        <li>Navigate to <a href="/admin/apikeys">Admin → API Keys</a></li>
                        <li>Click <strong>Generate New Key</strong></li>
                        <li>Copy the generated key (starts with <code>kub_</code>)</li>
                        <li>Use this key in all Java client code</li>
                    </ol>
                </div>

                <!-- Back to Help -->
                <div class="mt-5 text-center">
                    <a href="/help" class="btn btn-outline-primary">
                        <i class="fas fa-arrow-left me-2"></i>Back to Help Index
                    </a>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="py-4 mt-5 border-top">
            <div class="row">
                <div class="col-md-6">
                    <h6><i class="fas fa-database me-2"></i><span th:text="${appName} ?: 'Kuber'">Kuber</span> Distributed Cache</h6>
                    <p class="text-muted small mb-0">Version 1.7.2</p>
                </div>
                <div class="col-md-6 text-end">
                    <p class="text-muted small mb-0">
                        Copyright &copy; 2025-2030, All Rights Reserved<br>
                        Ashutosh Sinha | <a href="mailto:ajsinha@gmail.com">ajsinha@gmail.com</a><br>
                        <span class="badge bg-warning text-dark">Patent Pending</span>
                    </p>
                </div>
            </div>
        </footer>
    </div>
</main>

<th:block th:replace="~{layout :: scripts}"></th:block>

</body>
</html>
