<!DOCTYPE html>
<!--
  ~ Copyright © 2025-2030, All Rights Reserved
  ~ Ashutosh Sinha | Email: ajsinha@gmail.com
  ~ Patent Pending
  -->
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{layout :: head('C# Client')}"></head>
<body class="d-flex flex-column min-vh-100">

<nav th:replace="~{layout :: navbar}"></nav>

<main class="flex-fill">
    <div class="container py-4">
        <!-- Breadcrumb -->
        <nav aria-label="breadcrumb" class="mb-4">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="/help"><i class="fas fa-book me-1"></i>Help</a></li>
                <li class="breadcrumb-item active" aria-current="page">C# Client</li>
            </ol>
        </nav>

        <!-- Header -->
        <div class="text-center mb-5">
            <div class="mb-3">
                <i class="fab fa-microsoft fa-4x" style="color: #512BD4;"></i>
            </div>
            <h1 class="display-5 mb-3">C# / .NET Client Library</h1>
            <p class="lead text-muted">High-performance .NET client with Redis protocol, REST API, and messaging support</p>
        </div>

        <!-- Quick Navigation -->
        <div class="row g-3 mb-5">
            <div class="col-md-4">
                <a href="#redis-protocol" class="text-decoration-none">
                    <div class="card h-100 border-0 shadow-sm text-center py-3">
                        <i class="fas fa-bolt fa-2x text-danger mb-2"></i>
                        <h6 class="mb-0">Redis Protocol</h6>
                    </div>
                </a>
            </div>
            <div class="col-md-4">
                <a href="#rest-api" class="text-decoration-none">
                    <div class="card h-100 border-0 shadow-sm text-center py-3">
                        <i class="fas fa-cloud fa-2x text-primary mb-2"></i>
                        <h6 class="mb-0">REST API</h6>
                    </div>
                </a>
            </div>
            <div class="col-md-4">
                <a href="#messaging" class="text-decoration-none">
                    <div class="card h-100 border-0 shadow-sm text-center py-3">
                        <i class="fas fa-exchange-alt fa-2x text-success mb-2"></i>
                        <h6 class="mb-0">Messaging</h6>
                    </div>
                </a>
            </div>
        </div>

        <!-- Important Notices -->
        <div class="alert alert-warning mb-4">
            <i class="fas fa-key me-2"></i>
            <strong>v2.1.0: API Key Authentication Required</strong><br>
            All programmatic access requires an API key. Create one in <a href="/admin/apikeys">Admin → API Keys</a>.
        </div>
        
        <div class="alert alert-info mb-4">
            <i class="fas fa-shield-alt me-2"></i>
            <strong>v2.1.0: Role-Based Access Control</strong><br>
            Operations are authorized based on the user's roles. API keys inherit permissions from the associated user.
            Ensure your user has appropriate permissions (READ, WRITE, DELETE) for the regions you access.
            See <a href="/help/security">Security &amp; RBAC</a> for details.
        </div>

        <!-- Installation -->
        <div class="card mb-4">
            <div class="card-header bg-dark text-white">
                <h5 class="mb-0"><i class="fas fa-download me-2"></i>Installation</h5>
            </div>
            <div class="card-body">
                <h6>NuGet Package (Coming Soon)</h6>
                <pre class="bg-light p-3 rounded"><code>dotnet add package Kuber.Client</code></pre>
                
                <h6 class="mt-4">Build from Source</h6>
                <pre class="bg-light p-3 rounded"><code>cd kuber-client-csharp
dotnet build</code></pre>

                <h6 class="mt-4">Dependencies</h6>
                <pre class="bg-light p-3 rounded"><code>&lt;PackageReference Include="StackExchange.Redis" Version="2.7.33" /&gt;
&lt;PackageReference Include="System.Text.Json" Version="8.0.0" /&gt;

&lt;!-- Optional: For Kafka messaging --&gt;
&lt;PackageReference Include="Confluent.Kafka" Version="2.2.0" /&gt;

&lt;!-- Optional: For RabbitMQ messaging --&gt;
&lt;PackageReference Include="RabbitMQ.Client" Version="6.8.1" /&gt;</code></pre>
            </div>
        </div>

        <!-- Redis Protocol -->
        <div class="card mb-4" id="redis-protocol">
            <div class="card-header bg-danger text-white">
                <h5 class="mb-0"><i class="fas fa-bolt me-2"></i>Redis Protocol Client</h5>
            </div>
            <div class="card-body">
                <p>High-performance access using StackExchange.Redis. Recommended for production workloads.</p>
                
                <h6>Basic Usage</h6>
                <pre class="bg-light p-3 rounded"><code class="language-csharp">using Kuber.Client;

// Connect to Kuber
using var client = new KuberClient("localhost", 6379);

// Test connection
var latency = await client.PingAsync();
Console.WriteLine($"Connected! Latency: {latency.TotalMilliseconds}ms");

// Basic operations
await client.SetAsync("greeting", "Hello, Kuber!");
var value = await client.GetAsync("greeting");

// With TTL
await client.SetAsync("session:token", "abc123", TimeSpan.FromHours(1));

// Check TTL
var ttl = await client.TtlAsync("session:token");
Console.WriteLine($"TTL: {ttl?.TotalSeconds} seconds");</code></pre>

                <h6 class="mt-4">Batch Operations</h6>
                <pre class="bg-light p-3 rounded"><code class="language-csharp">// Set multiple keys
await client.MSetAsync(new Dictionary&lt;string, string&gt;
{
    ["user:1:name"] = "Alice",
    ["user:1:email"] = "alice@example.com",
    ["user:2:name"] = "Bob",
    ["user:2:email"] = "bob@example.com"
});

// Get multiple keys
var users = await client.MGetAsync("user:1:name", "user:1:email", "user:2:name");
foreach (var kv in users)
{
    Console.WriteLine($"{kv.Key}: {kv.Value ?? "(null)"}");
}</code></pre>

                <h6 class="mt-4">Hash Operations</h6>
                <pre class="bg-light p-3 rounded"><code class="language-csharp">// Set individual fields
await client.HSetAsync("session:abc123", "user_id", "1001");
await client.HSetAsync("session:abc123", "ip", "192.168.1.100");

// Set multiple fields
await client.HMSetAsync("session:abc123", new Dictionary&lt;string, string&gt;
{
    ["browser"] = "Chrome",
    ["os"] = "Windows 11"
});

// Get all fields
var session = await client.HGetAllAsync("session:abc123");
foreach (var field in session)
{
    Console.WriteLine($"  {field.Key}: {field.Value}");
}

// Get single field
var userId = await client.HGetAsync("session:abc123", "user_id");</code></pre>

                <h6 class="mt-4">JSON Operations</h6>
                <pre class="bg-light p-3 rounded"><code class="language-csharp">// Store JSON object
var product = new
{
    Id = 5001,
    Name = "Gaming Laptop",
    Price = 1299.99,
    TempField = "temporary",
    Specs = new { Cpu = "Intel i9", Ram = "32GB" }
};
await client.JsonSetAsync("product:5001", product);

// Retrieve as strongly-typed object
public record Product(int Id, string Name, decimal Price, ProductSpecs Specs);
public record ProductSpecs(string Cpu, string Ram);

var retrieved = await client.JsonGetAsync&lt;Product&gt;("product:5001");
Console.WriteLine($"Product: {retrieved?.Name}, ${retrieved?.Price}");

// Update/merge JSON (new in v1.7.2) - upsert with deep merge
var updates = new { Price = 1199.99, Stock = 50 };
await client.JsonUpdateAsync("product:5001", updates);
// Result: merges updates into existing document

// Remove attributes from JSON (new in v1.7.2)
await client.JsonRemoveAsync("product:5001", new[] { "TempField" });
// Result: removes TempField from the document</code></pre>

                <h6 class="mt-4">Key Operations</h6>
                <pre class="bg-light p-3 rounded"><code class="language-csharp">// Find keys by pattern
foreach (var key in client.Keys("user:*"))
{
    Console.WriteLine(key);
}

// Check existence
bool exists = await client.ExistsAsync("greeting");

// Delete keys
await client.DeleteAsync("key1", "key2", "key3");

// Set expiration
await client.ExpireAsync("session:token", TimeSpan.FromMinutes(30));</code></pre>

                <h6 class="mt-4">Region Support</h6>
                <pre class="bg-light p-3 rounded"><code class="language-csharp">// Create client for specific region
using var analyticsClient = new KuberClient("localhost", 6379, region: "analytics");
await analyticsClient.SetAsync("pageviews:today", "15234");

// Or switch regions
var sessionClient = client.WithRegion("sessions");
await sessionClient.SetAsync("active:count", "1000");</code></pre>
            </div>
        </div>

        <!-- REST API -->
        <div class="card mb-4" id="rest-api">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0"><i class="fas fa-cloud me-2"></i>REST API Client</h5>
            </div>
            <div class="card-body">
                <p>HTTP-based access with API key authentication. Ideal for web applications and microservices.</p>
                
                <h6>Basic Usage</h6>
                <pre class="bg-light p-3 rounded"><code class="language-csharp">using Kuber.Client;

// Connect with API key
using var client = new KuberRestClient(
    "http://localhost:8080",
    "your-api-key-here"
);

// Test connection
bool isAlive = await client.PingAsync();

// Basic operations
await client.SetAsync("greeting", "Hello from C#!");
var value = await client.GetAsync("greeting");

// With TTL (in seconds)
await client.SetAsync("session:token", "xyz789", ttlSeconds: 3600);</code></pre>

                <h6 class="mt-4">JSON Operations</h6>
                <pre class="bg-light p-3 rounded"><code class="language-csharp">// Store complex JSON
var order = new
{
    OrderId = "ORD-2025-001",
    Customer = new
    {
        Id = 1001,
        Name = "Alice Johnson"
    },
    Items = new[]
    {
        new { ProductId = "P001", Name = "Laptop", Price = 999.99 },
        new { ProductId = "P002", Name = "Mouse", Price = 29.99 }
    },
    Total = 1029.98,
    TempNote = "pending review"
};
await client.JsonSetAsync("order:2025-001", order);

// Retrieve with JSONPath
var customerName = await client.JsonGetAsync&lt;string&gt;("order:2025-001", "$.Customer.Name");

// Update/merge JSON (new in v1.7.2)
var updates = new { Status = "shipped", ShipDate = DateTime.Now };
await client.JsonUpdateAsync("order:2025-001", updates);

// Remove attributes (new in v1.7.2)
await client.JsonRemoveAsync("order:2025-001", new[] { "TempNote" });

// Search JSON documents
var results = await client.JsonSearchAsync("Total > 500");
foreach (var result in results)
{
    Console.WriteLine($"Key: {result.Key}, Value: {result.Value}");
}</code></pre>

                <h6 class="mt-4">Server Information</h6>
                <pre class="bg-light p-3 rounded"><code class="language-csharp">// Get server info
var info = await client.InfoAsync();
Console.WriteLine($"Version: {info?.Version}");
Console.WriteLine($"Uptime: {info?.Uptime} seconds");
Console.WriteLine($"Total Keys: {info?.TotalKeys}");

// List regions
var regions = await client.RegionsAsync();
foreach (var region in regions)
{
    Console.WriteLine($"  {region}");
}</code></pre>
            </div>
        </div>

        <!-- Messaging -->
        <div class="card mb-4" id="messaging">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0"><i class="fas fa-exchange-alt me-2"></i>Request/Response Messaging</h5>
            </div>
            <div class="card-body">
                <p>Build cache operation requests for message broker integration (Kafka, RabbitMQ, ActiveMQ, IBM MQ).</p>
                
                <h6>Building Requests</h6>
                <pre class="bg-light p-3 rounded"><code class="language-csharp">using Kuber.Client;

var client = new KuberMessagingClient("your-api-key");

// Build various requests
var getRequest = client.BuildGet("user:1001");
var setRequest = client.BuildSet("user:1002", new { Name = "Jane" }, ttl: 3600);
var mgetRequest = client.BuildMGet(new List&lt;string&gt; { "key1", "key2", "key3" });
var msetRequest = client.BuildMSet(new Dictionary&lt;string, object&gt;
{
    ["config:theme"] = "dark",
    ["config:lang"] = "en-US"
});

// Serialize to JSON
string json = client.ToJson(getRequest);

// Send to your message broker's request topic...</code></pre>

                <h6 class="mt-4">Message Format</h6>
                <pre class="bg-light p-3 rounded"><code class="language-json">// Request (sent to kuber_request topic)
{
  "api_key": "your-api-key",
  "message_id": "550e8400-e29b-41d4-a716-446655440000",
  "operation": "GET",
  "region": "default",
  "key": "user:1001"
}

// Response (received from kuber_response topic)
{
  "request_receive_timestamp": "2025-01-15T10:30:00.123Z",
  "response_time": "2025-01-15T10:30:00.125Z",
  "processing_time_ms": 2,
  "request": { /* original request */ },
  "response": {
    "success": true,
    "result": "{\"name\": \"John\", \"email\": \"john@example.com\"}",
    "error": ""
  }
}</code></pre>

                <h6 class="mt-4">Parsing Responses</h6>
                <pre class="bg-light p-3 rounded"><code class="language-csharp">// Parse response from broker
string responseJson = /* received from broker */;
var response = client.ParseResponse(responseJson);

if (response?.Response?.Success == true)
{
    Console.WriteLine($"Result: {response.Response.Result}");
    
    // Check for server messages (e.g., truncation warnings)
    if (!string.IsNullOrEmpty(response.Response.ServerMessage))
    {
        Console.WriteLine($"Server: {response.Response.ServerMessage}");
    }
}
else
{
    Console.WriteLine($"Error: {response?.Response?.Error}");
    Console.WriteLine($"Code: {response?.Response?.ErrorCode}");
}</code></pre>

                <h6 class="mt-4">Supported Operations</h6>
                <div class="table-responsive">
                    <table class="table table-sm table-striped">
                        <thead>
                            <tr>
                                <th>Operation</th>
                                <th>Builder Method</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>GET</td><td><code>BuildGet(key)</code></td><td>Get value by key</td></tr>
                            <tr><td>SET</td><td><code>BuildSet(key, value, ttl?)</code></td><td>Set key-value pair</td></tr>
                            <tr><td>DELETE</td><td><code>BuildDelete(key)</code></td><td>Delete key</td></tr>
                            <tr><td>MGET</td><td><code>BuildMGet(keys)</code></td><td>Get multiple keys</td></tr>
                            <tr><td>MSET</td><td><code>BuildMSet(entries, ttl?)</code></td><td>Set multiple keys</td></tr>
                            <tr><td>KEYS</td><td><code>BuildKeys(pattern)</code></td><td>Find keys by pattern</td></tr>
                            <tr><td>EXISTS</td><td><code>BuildExists(key)</code></td><td>Check key existence</td></tr>
                            <tr><td>TTL</td><td><code>BuildTtl(key)</code></td><td>Get remaining TTL</td></tr>
                            <tr><td>EXPIRE</td><td><code>BuildExpire(key, ttl)</code></td><td>Set expiration</td></tr>
                            <tr><td>HGET</td><td><code>BuildHGet(key, field)</code></td><td>Get hash field</td></tr>
                            <tr><td>HSET</td><td><code>BuildHSet(key, field, value)</code></td><td>Set hash field</td></tr>
                            <tr><td>HGETALL</td><td><code>BuildHGetAll(key)</code></td><td>Get all hash fields</td></tr>
                            <tr><td>HMSET</td><td><code>BuildHMSet(key, fields)</code></td><td>Set multiple hash fields</td></tr>
                            <tr><td>JSET</td><td><code>BuildJSet(key, value)</code></td><td>Set JSON document</td></tr>
                            <tr><td>JGET</td><td><code>BuildJGet(key, path?)</code></td><td>Get JSON (with optional path)</td></tr>
                            <tr><td>JUPDATE</td><td><code>BuildJUpdate(key, value, ttl?)</code></td><td>Update/merge JSON (upsert)</td></tr>
                            <tr><td>JREMOVE</td><td><code>BuildJRemove(key, attrs)</code></td><td>Remove attributes from JSON</td></tr>
                            <tr><td>JSEARCH</td><td><code>BuildJSearch(query)</code></td><td>Search JSON documents</td></tr>
                            <tr><td>PING</td><td><code>BuildPing()</code></td><td>Health check</td></tr>
                            <tr><td>INFO</td><td><code>BuildInfo()</code></td><td>Server information</td></tr>
                            <tr><td>REGIONS</td><td><code>BuildRegions()</code></td><td>List regions</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- API Reference -->
        <div class="card mb-4">
            <div class="card-header bg-secondary text-white">
                <h5 class="mb-0"><i class="fas fa-code me-2"></i>API Reference</h5>
            </div>
            <div class="card-body">
                <h6>KuberClient (Redis Protocol)</h6>
                <div class="table-responsive">
                    <table class="table table-sm table-striped">
                        <thead>
                            <tr>
                                <th>Method</th>
                                <th>Return Type</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td><code>GetAsync(key)</code></td><td><code>Task&lt;string?&gt;</code></td><td>Get value</td></tr>
                            <tr><td><code>SetAsync(key, value, expiry?)</code></td><td><code>Task&lt;bool&gt;</code></td><td>Set value</td></tr>
                            <tr><td><code>DeleteAsync(key)</code></td><td><code>Task&lt;bool&gt;</code></td><td>Delete key</td></tr>
                            <tr><td><code>DeleteAsync(keys[])</code></td><td><code>Task&lt;long&gt;</code></td><td>Delete multiple keys</td></tr>
                            <tr><td><code>ExistsAsync(key)</code></td><td><code>Task&lt;bool&gt;</code></td><td>Check existence</td></tr>
                            <tr><td><code>MGetAsync(keys[])</code></td><td><code>Task&lt;Dict&lt;string, string?&gt;&gt;</code></td><td>Get multiple</td></tr>
                            <tr><td><code>MSetAsync(keyValues)</code></td><td><code>Task&lt;bool&gt;</code></td><td>Set multiple</td></tr>
                            <tr><td><code>Keys(pattern)</code></td><td><code>IEnumerable&lt;string&gt;</code></td><td>Find keys</td></tr>
                            <tr><td><code>TtlAsync(key)</code></td><td><code>Task&lt;TimeSpan?&gt;</code></td><td>Get TTL</td></tr>
                            <tr><td><code>ExpireAsync(key, expiry)</code></td><td><code>Task&lt;bool&gt;</code></td><td>Set expiration</td></tr>
                            <tr><td><code>PersistAsync(key)</code></td><td><code>Task&lt;bool&gt;</code></td><td>Remove expiration</td></tr>
                            <tr><td><code>HGetAsync(key, field)</code></td><td><code>Task&lt;string?&gt;</code></td><td>Get hash field</td></tr>
                            <tr><td><code>HSetAsync(key, field, value)</code></td><td><code>Task&lt;bool&gt;</code></td><td>Set hash field</td></tr>
                            <tr><td><code>HGetAllAsync(key)</code></td><td><code>Task&lt;Dict&lt;string, string&gt;&gt;</code></td><td>Get all fields</td></tr>
                            <tr><td><code>HMSetAsync(key, fields)</code></td><td><code>Task</code></td><td>Set multiple fields</td></tr>
                            <tr><td><code>HDelAsync(key, fields[])</code></td><td><code>Task&lt;long&gt;</code></td><td>Delete fields</td></tr>
                            <tr><td><code>JsonSetAsync&lt;T&gt;(key, doc)</code></td><td><code>Task&lt;bool&gt;</code></td><td>Store JSON</td></tr>
                            <tr><td><code>JsonGetAsync&lt;T&gt;(key)</code></td><td><code>Task&lt;T?&gt;</code></td><td>Retrieve JSON</td></tr>
                            <tr><td><code>JsonUpdateAsync&lt;T&gt;(key, doc)</code></td><td><code>Task&lt;T?&gt;</code></td><td>Update/merge JSON</td></tr>
                            <tr><td><code>JsonRemoveAsync(key, attrs[])</code></td><td><code>Task&lt;bool&gt;</code></td><td>Remove JSON attributes</td></tr>
                            <tr><td><code>JsonSearchAsync(query)</code></td><td><code>Task&lt;List&lt;T&gt;&gt;</code></td><td>Search JSON documents</td></tr>
                            <tr><td><code>PingAsync()</code></td><td><code>Task&lt;TimeSpan&gt;</code></td><td>Test connection</td></tr>
                            <tr><td><code>WithRegion(region)</code></td><td><code>KuberClient</code></td><td>Get regional client</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Examples -->
        <div class="card mb-4">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0"><i class="fas fa-play-circle me-2"></i>Running Examples</h5>
            </div>
            <div class="card-body">
                <pre class="bg-light p-3 rounded"><code># Run interactive example selector
cd kuber-client-csharp/examples
dotnet run

# Run specific examples
dotnet run -- redis      # Redis protocol example
dotnet run -- rest       # REST API example
dotnet run -- messaging  # Messaging example

# Show detailed message formats
dotnet run -- messaging --examples</code></pre>
            </div>
        </div>

        <!-- Navigation -->
        <div class="d-flex justify-content-between mt-5 pt-4 border-top">
            <a href="/help/python-client" class="btn btn-outline-secondary">
                <i class="fas fa-arrow-left me-2"></i>Python Client
            </a>
            <a href="/help" class="btn btn-outline-primary">
                <i class="fas fa-book me-2"></i>Back to Help
            </a>
            <a href="/help/java-client" class="btn btn-outline-secondary">
                Java Client<i class="fas fa-arrow-right ms-2"></i>
            </a>
        </div>
    </div>
</main>

<footer th:replace="~{layout :: footer}"></footer>

<th:block th:replace="~{layout :: scripts}"></th:block>

</body>
</html>
